(()=>{var h={".":"this.","e.":"window.eventLoop.event.","t.":"window.eventLoop.event.target.","w.":"window.","d.":"window.document.","oi.":"oi.","at.":"window.eventLoop.attribute.","el.":"window.eventLoop.attribute.ownerElement.","this.":"this.","window.":"window.","document.":"document."};function E(n){for(let t in h)if(n.startsWith(t))return DoubleDots.kebabToPascal(h[t]+n.slice(t.length))}var k=/^((-?\d+(\.\d+)?([eE][-+]?\d+)?)|this|window|document|i|e|true|false|undefined|null)$/;function p(n){let[t,...e]=n.split("_"),r=E(t);e=e.map(a=>E(a)||k.test(a)?a:`"${a}"`);let u=e.join(", "),y=e.length?e.length===1?`=${u}`:`=[${u}]`:"";return`(${r} instanceof Function ? ${r}(${u}) : (${r}${y}))`}function b(n){let e=`function dotReaction(oi) { return ${p(n)}; }`;return DoubleDots.importBasedEval(e)}function D(n){let e=`function dotReaction(oi) { return ${p(n.slice(2))} || EventLoop.break; }`;return DoubleDots.importBasedEval(e)}function N(n){let e=`function dotReaction(oi) { return ${p(n.slice(2))} && EventLoop.break; }`;return DoubleDots.importBasedEval(e)}function A(n){let t=parseInt(n.slice(2));if(!t||isNaN(t))throw new DoubleDots.SyntaxError("ReactionJump only accept positive and negative integers: "+n.slice(2));return DoubleDots.importBasedEval(`_ => new EventLoop.ReactionJump(${t})`)}var c={};for(let n in h)c[n]=b;c["x."]=D;c["y."]=N;c["j."]=A;var _=new DoubleDots.AttrWeakSet,v=class extends AttrCustom{upgrade(){_.add(this)}};var f=class{constructor(t,e=Attr){this.elIt=document.createNodeIterator(t,NodeFilter.SHOW_ELEMENT),this.Type=e,this.attr=void 0,this.nextElement()}nextElement(){this.el=this.elIt.nextNode(),this.i=0,this.attributes=this.el?Array.from(this.el.attributes):[]}next(){var t;for(;(t=this.el)!=null&&t.isConnected;){for(;this.i<this.attributes.length;)if(this.attr=this.attributes[this.i++],this.attr.ownerElement&&this.attr instanceof this.Type)return{value:this.attr,done:!1};this.nextElement()}return this.attr=void 0,{done:!0}}[Symbol.iterator](){return this}},m=class extends f{constructor(t,e=Attr){super(t,e),this.stack=[]}next(){var r;let t=super.next();if(t.done)return t;for(;this.stack.length&&!this.stack[0].el.contains(this.el);)this.stack.shift();let e=this.makePath(t.value,(r=this.stack[0])==null?void 0:r.path);return this.stack.unshift(e),t}makePath({ownerElement:t,value:e},r=[]){return e=e.split("."),e=e[0]?e:[...r,...e.slice(1)],{el:t,path:e}}get currentPath(){return this.stack[0].path}};function R(n){for(;n;n=n.parentElement)if(n.pp)return n.pp}var d=class extends Event{constructor(t,e,r){super(t),this.IT=r,this.root=e}get[Event.data](){let t=this.root,e;for(e of o.currentPath)t=t==null?void 0:t[e];return t instanceof Object?Object.assign({"#key":e},t):{"#key":e,"#value":t}}};function O(n,t){o=new m(n,s),eventLoop.dispatchBatch(new d("pp",t,o),o)}var o;var s=class extends AttrCustom{upgrade(){for(let t of this.ownerElement.attributes)if(t!==this&&t instanceof s)throw new Error("An element can only hold one "+this.trigger+":")}set value(t){if(super.value=t,o!=null&&o.attr){if(o.attr===this)throw new Error("reactions on pp: trigger cannot change their own value!");if(!o.attr.ownerElement.contains(this.ownerElement))throw new Error("pp: mutation outside scope: "+o.attr.ownerElement+" >! "+this.ownerElement);return}let e=R(this.ownerElement);e&&O(this.ownerElement,e)}get value(){return super.value}};var i=class extends AttrListener{get target(){return window}},l=class extends AttrListener{get target(){return document}},w=class extends l{get type(){return"DOMContentLoaded"}},g=class extends i{get type(){return this.trigger.slice(1)}get options(){return!0}},x=class extends i{get type(){return this.trigger.slice(-1)}};function $(){let n=e=>e[0].toUpperCase()+e.slice(1),t={};for(let e of DoubleDots.nativeEvents.element)e=n(e),t[e]=AttrListener,t["_"+e]=g,t[e+"_"]=x;for(let e of DoubleDots.nativeEvents.window)t[n(e)]=i;for(let e of DoubleDots.nativeEvents.document)t[n(e)]=l;return delete t.DOMContentLoaded,t.Domcontentloaded=w,t}var F=$();})();
//# sourceMappingURL=ddx.js.map
