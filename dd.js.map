{
  "version": 3,
  "sources": ["src/dd/1_DoubleDots.js", "src/dd/2_AttrCustom.js", "src/dd/3_definition_registers_v4.js", "src/dd/4_eventLoop_v2.js", "src/dd/5_load_DoubleDots.js", "x/template/v1.js", "src/dd/6_run_DoubleDots.js"],
  "sourcesContent": ["const dce = document.createElement;\nconst ael = EventTarget.prototype.addEventListener;\nconst si = setInterval;\nconst st = setTimeout;\n\nasync function sleep(ms) {\n  return await new Promise(r => st(r, ms));\n}\n\nfunction nextTick(cb) {\n  const a = dce.call(document, \"audio\");\n  ael.call(a, \"ratechange\", cb);\n  a.playbackRate = 2;\n}\n\nclass AttrWeakSet extends Set {\n  static #bigSet = new Set(); //wr => AttrWeakSet\n  static #key;\n  static GC = 10_000;\n\n  static gc() {\n    let active, l;\n    for (let wr of AttrWeakSet.#bigSet) {\n      if (l = wr.deref())\n        for (let a of l)\n          a.isConnected ? (active = true) : (l.delete(a), a.remove());\n      else\n        AttrWeakSet.#bigSet.delete(wr);\n\n    }\n    !active && (AttrWeakSet.#key = clearInterval(AttrWeakSet.#key));\n  }\n\n  constructor(...args) {\n    super(...args);\n    AttrWeakSet.#bigSet.add(new WeakRef(this));\n  }\n\n  add(at) {\n    AttrWeakSet.#key ??= si(AttrWeakSet.gc, AttrWeakSet.GC);\n    super.add(at);\n  }\n}\n\nconst nativeEvents = (function () {\n  function extractHandlers(obj) {\n    return Object.keys(obj)\n      .filter(k => k.startsWith(\"on\"))\n      .map(k => k.substring(2).toLowerCase());\n  }\n  const eOn = extractHandlers(Element.prototype);\n  const hOn = extractHandlers(HTMLElement.prototype);\n  const wOn = extractHandlers(window);\n  const dOn = extractHandlers(Document.prototype);\n\n  const e = [...eOn, ...hOn].filter((a, i, ar) => ar.indexOf(a) === i);\n  const w = wOn.filter(x => !e.includes(x));\n  const d = dOn.filter(x => !e.includes(x) && !w.includes(x));\n  //todo should I switch the difference between window and document?\n  const result = { element: e, window: w, document: d };\n  result.element.push(\"touchstart\", \"touchmove\", \"touchend\", \"touchcancel\");\n  result.document.push(\"DOMContentLoaded\");\n  Object.values(result).forEach(Object.freeze);\n  Object.freeze(result);\n  return result;\n})();\n\nfunction kebabToPascal(str) {\n  return str.replace(/-[a-z]/g, c => c[1].toUpperCase());\n}\n\nfunction pascalToKebab(str) {\n  return str.replace(/[A-Z]/g, c => '-' + c.toLowerCase());\n}\n\nfunction pascalToCamel(str) {\n  return str.replace(/^(_*)([A-Z])/, (_, _s, c) => _s + c.toLowerCase());\n}\n\n/**\n* This method is just as bad as eval. But, \n* if you use this during development, and \n* then switch to a static Reaction Trigger in production,\n* then you will be fine.\n* \n* @param {string} The body of the function to be created from the string.\n* @returns Function \n*/\nasync function importBasedEval(codeString) {\n  codeString = \"export default \" + codeString.trim();\n  const blob = new Blob([codeString], { type: 'application/javascript' });\n  const url = URL.createObjectURL(blob);\n  const module = await import(url);\n  URL.revokeObjectURL(url);\n  return module.default;\n}\n\n/**\n * miniQuerySelector\n * \n * Converts miniQuerySelector given in super limited DoubleDots notation\n * into a valid css querySelector.\n * \n * For example: \n *     my-element.foo.bar_attr-hello.._sunshine_active\n * =>  my-element.foo.bar[attr-hello\\:$=\"sunshine\"][active]\n * \n * @param {string} doubledot: \n * @returns {string} querySelector\n */\nfunction miniQuerySelector(doubledot) {\n  let [q, ...attrs] = doubledot.split(\"_\");\n  for (let i = 0; i <= attrs.length - 1; i += 2) {\n    const name = attrs[i].replaceAll(\"..\", \"\\\\:\");\n    const val = i <= attrs.length ? `$=\"${attrs[i + 1]}\"` : \"\";\n    q += `[${name}${val}]`;\n  }\n  return q;\n};\n\nfunction* up(el, q = \"*\") {\n  for (let p = el.parentElement; p; p = p.parentElement)\n    if (q === \"*\" || p.matches(q))\n      yield p;\n}\nfunction* left(el, q = \"*\") {\n  for (let s = el.previousElementSibling; s; s = s.previousElementSibling)\n    if (q === \"*\" || s.matches(q))\n      yield s;\n}\nfunction* right(el, q = \"*\") {\n  for (let s = el.nextElementSibling; s; s = s.nextElementSibling)\n    if (q === \"*\" || s.matches(q))\n      yield s;\n}\nfunction* roots(el) {\n  for (let r = el.getRootNode(); r; r = r.host?.getRootNode())\n    yield r;\n}\nfunction* hosts(el, q = \"*\") {\n  for (let h = el.getRootNode().host; h; h = h.getRootNode().host)\n    if (q === \"*\" || h.matches(q))\n      yield h;\n}\nfunction* downwide(el, q = \"*\") {\n  for (let d, queue = [...el.children]; d = queue.shift(); queue.push(...el.children))\n    if (q === \"*\" || d.matches(q))\n      yield d;\n}\n\nclass DoubleDotsError extends Error {\n  constructor(msg, at) {\n    super(msg);\n    //todo handle at\n  }\n}\n\nclass ThisArrowFunctionError extends DoubleDotsError {\n  constructor(Func) {\n    super(\"arrow function with `this`.\");\n  }\n  static check(Definition) {\n    // if(Definition.hasOwnProperty('prototype'))  //better alternative than a\n    //   return false;\n    let txt = Definition.toString();\n    if (!/^(async\\s+|)(\\(|[^([]+=)/.test(txt))  //alternative a\n      return;\n    txt = txt.replace(/\\/\\*[\\s\\S]*?\\*\\/|([^\\\\:]|^)\\/\\/.*$/gm, ''); //remove comments\n    //ATT!! `${\"`\"}this` only works when \"\" is removed before ``\n    txt = txt.replace(/([\"'])(?:(?=(\\\\?))\\2.)*?\\1/g, '');   //remove \"'-strings\n    txt = txt.replace(/(`)(?:(?=(\\\\?))\\2.)*?\\1/g, '');   //remove `strings\n    if (/\\bthis\\b/.test(txt))                      //the word this\n      throw new ThisArrowFunctionError(Definition);\n  }\n}\n\nwindow.DoubleDots = {\n  nativeMethods: {},\n\n  DoubleDotsError,\n  ThisArrowFunctionError,\n  DeprecationError: class DeprecationError extends DoubleDotsError { },\n  MissingReaction: class MissingReaction extends DoubleDotsError { },\n  DisconnectedError: class DisconnectedError extends DoubleDotsError { },\n  TriggerUpgradeError: class TriggerUpgradeError extends DoubleDotsError {\n    constructor(at, error) {\n      super(at);\n      //todo\n    }\n\n  },\n  AttrWeakSet,\n  nextTick,\n  sleep,\n  nativeEvents,\n  kebabToPascal,\n  pascalToKebab,\n  pascalToCamel,\n  up, left, right, roots, hosts, downwide,\n  importBasedEval,\n  miniQuerySelector\n};\n", "class AttrCustom extends Attr {\n\n  // Interface\n  // set value(newValue) { const oldValue = super.value; super.value = newValue; ... }\n  // upgrade(){ super.upgrade(); ... }\n  // remove(){ ...; super.remove() }\n\n  static #makeRT(at) {\n    let [trigger, ...reactions] = at.name.split(\":\");\n    reactions.length === 1 && !reactions[0] && reactions.pop();\n    Object.defineProperties(at, {\n      \"trigger\": { value: trigger, enumerable: true },\n      \"reactions\": { value: reactions, enumerable: true },\n    });\n  }\n\n  get trigger() {\n    return AttrCustom.#makeRT(this), this.trigger;\n  }\n\n  get reactions() {\n    return AttrCustom.#makeRT(this), this.reactions;\n  }\n\n  isConnected() {\n    return this.ownerElement.isConnected();\n  }\n\n  getRootNode(...args) {\n    return this.ownerElement?.getRootNode(...args);\n  }\n\n  remove() {\n    return this.ownerElement.removeAttribute(this.name);\n  }\n\n  //todo remove this and only use eventLoop.dispatchBatch(e, attrs);\n  dispatchEvent(e) {\n    if (!this.isConnected)\n      throw new DoubleDots.ReactionError(\"dispatch on disconnected attribute.\");\n    eventLoop.dispatch(e, this);\n  }\n\n  static upgradeBranch(...els) {\n    for (let el of els) {\n      if (el instanceof Element)\n        this.upgradeElementRoot(el);\n      else if (el instanceof DocumentFragment)\n        for (let c of el.children)\n          this.upgradeElementRoot(c);\n    }\n    //todo we don't want to run the eventLoop until all the attr are upgraded.\n  }\n\n  static upgradeElementRoot(el) {\n    for (let at of el.attributes)\n      if (at.name.includes(\":\"))\n        AttrCustom.upgrade(at);\n    for (let c of el.children)\n      this.upgradeElementRoot(c);\n    // for (let desc of el.querySelectorAll(\"*\"))\n    //   for (let at of desc.attributes)\n    //     if (at.name.includes(\":\"))\n    //       AttrCustom.upgrade(at);\n  }\n\n  static upgrade(at, Def) {\n    Def ??= at.ownerElement.getRootNode().Triggers.get(at.name.split(\":\")[0], at);\n    if (Def instanceof Error)\n      throw Def;\n    if (Def instanceof Promise) {\n      Object.setPrototypeOf(at, AttrUnknown.prototype);\n      Def.then(Def => AttrCustom.upgrade(at, Def));\n      return;\n    }\n    try {\n      Object.setPrototypeOf(at, Def.prototype);\n      at.upgrade?.();\n      at.value && (at.value = at.value);\n    } catch (err) {\n      throw new DoubleDots.TriggerUpgradeError(Def.name + \".upgrade() caused an error. Triggers shouldn't cause errors.\");\n    }\n  }\n}\nclass AttrImmutable extends AttrCustom {\n  remove() { /* cannot be removed */ }\n  //set value() { /* cannot be changed */ }\n  //get value() { return super.value; }\n}\n\nclass AttrUnknown extends AttrCustom { }\n\nconst stopProp = Event.prototype.stopImmediatePropagation;\nconst addEventListenerOG = EventTarget.prototype.addEventListener;\nconst removeEventListenerOG = EventTarget.prototype.removeEventListener;\n\nconst listenerReg = {};\nObject.defineProperty(Event, \"activeListeners\", {\n  enumerable: true,\n  value: function activeListeners(name) {\n    return listenerReg[name];\n  }\n});\n\nclass AttrListener extends AttrCustom {\n  upgrade() {\n    Object.defineProperty(this, \"__l\", { value: this.run.bind(this) });\n    addEventListenerOG.call(this.target, this.type, this.__l, this.options);\n    listenerReg[this.type] = (listenerReg[this.type] || 0) + 1;\n  }\n\n  remove() {\n    listenerReg[this.type] -= 1;\n    removeEventListenerOG(this.target, this.type, this.__l, this.options);\n    super.remove();\n  }\n\n  get target() {\n    return this.ownerElement;\n  }\n\n  get type() {\n    return this.trigger;\n  }\n\n  // get options(){ \n  //   return undefined; this is redundant to implement\n  // }\n\n  run(e) {\n    // !this.isConnected && this.remove();\n    eventLoop.dispatch(e, this);\n  }\n}\n\nclass AttrListenerGlobal extends AttrListener {\n\n  // We can hide the triggers in JS space. But this makes later steps much worse.\n  //\n  // static #triggers = new WeakMap();\n  // get register() {\n  //   let dict = AttrListenerGlobal.#triggers.get(this.target);\n  //   !dict && AttrListenerGlobal.#triggers.set(this.target, dict = {});\n  //   return dict[this.trigger] ??= DoubleDots.AttrWeakSet();\n  // }\n\n  get register() {\n    let dict = this.target.triggers;\n    if (!dict)\n      Object.defineProperty(this.target, \"triggers\", { value: dict = {} });\n    return dict[this.trigger] ??= DoubleDots.AttrWeakSet();\n  }\n\n  get target() {\n    return window;\n  }\n\n  upgrade() {\n    super.upgrade();\n    this.register.add(this);\n  }\n\n  remove() {\n    this.register.delete(this);\n    super.remove();\n  }\n\n  run(e) {\n    // if (!this.isConnected)\n    //   return this.remove();\n    stopProp.call(e);\n    // eventLoop.dispatch(e, ...this.register);\n    eventLoop.dispatchBatch(e, this.register);\n  }\n}\n\n/**\n * AttrMutation is the only needed main base for MutationObserver.\n * With AttrMutation we can deprecate MutationObserver.\n * All other MutationObserver triggers should use AttrMutation.\n */\nclass AttrMutation extends AttrCustom {\n  upgrade() {\n    const observer = new MutationObserver(this.run.bind(this));\n    Object.defineProperty(this, \"observer\", { value: observer });\n    this.observer.observe(this.target, this.settings);\n  }\n\n  remove() {\n    this.observer.disconnect();\n    super.remove();\n  }\n\n  get target() {\n    return this.ownerElement;\n  }\n\n  get settings() {\n    return { attributes: true, attributesOldValue: true };\n  }\n\n  run(mrs) {\n    for (let mr of mrs)\n      eventLoop.dispatch(mr, this); //one event per attribute changed.\n  }\n}\n\n/**\n * works out of the box using:\n * \n * documents.Triggers.define(\"content-box\", AttrResize);\n * documents.Triggers.define(\"border-box\", AttrResize);\n * documents.Triggers.define(\"device-pixel-content-box\", AttrResize);\n */\nclass AttrResize extends AttrCustom {\n  upgrade() {\n    const observer = new ResizeObserver(this.run.bind(this));\n    Object.defineProperty(this, \"observer\", { value: observer });\n    this.observer.observe(this.ownerElement, this.settings);\n  }\n\n  remove() {\n    this.observer.disconnect();\n    super.remove();\n  }\n\n  get settings() {\n    return { box: this.trigger };\n  }\n\n  run(entries) {\n    eventLoop.dispatch(entries, this);\n  }\n}\n\n/**\n * AttrIntersection is the main base for IntersectionObserver.\n * With AttrIntersection we can deprecate IntersectionObserver.\n * All other IntersectionObserver triggers should use AttrIntersection.\n */\nclass AttrIntersection extends AttrCustom {\n  upgrade() {\n    const observer = new IntersectionObserver(this.run.bind(this));\n    Object.defineProperty(this, \"observer\", { value: observer });\n    this.observer.observe(this.ownerElement, this.settings);\n  }\n\n  stop() {\n    this.observer.disconnect();\n  }\n\n  remove() {\n    this.stop();\n    super.remove();\n  }\n\n  // get settings() {\n  //   return { threshold: 0.0, root: null, rootMargin: '0px 0px 0px 0px' };\n  // }\n\n  run([mr]) {\n    //todo add a native event listener for the DOMContentLoaded or readystatechange?\n    //todo and then ensure that the inview is called on all elements that are then inview?\n    //should we await sleep() on it??\n    document.readyState === \"complete\" && eventLoop.dispatch(mr, this);\n  }\n}\n\nObject.assign(window, {\n  AttrListener,\n  AttrListenerGlobal,\n  AttrCustom,\n  AttrImmutable,\n  AttrUnknown,\n  AttrMutation,\n  AttrIntersection,\n  AttrResize\n});", "class DefinitionError extends DoubleDots.DoubleDotsError {\n  constructor(msg, fullname, rule, RuleFun) {\n    super(msg);\n    this.fullname = fullname;\n    this.rule = rule;\n    this.RuleFun = RuleFun;\n  }\n}\n\nclass TriggerNameError extends DefinitionError {\n  constructor(fullname) {\n    super(`Trigger name/prefix must begin with english letter or '_'.\\n${fullname} begins with '${fullname[0]}'.`);\n  }\n\n  static check(name) {\n    if (!name.match(/[a-z_].*/))\n      throw new TriggerNameError(name);\n  }\n}\n\nclass DefinitionNameError extends DefinitionError {\n  constructor(name) {\n    super(`DoubleDots definition names and rule prefixes can only contain /^[a-z0-9_\\.-]*$/: ${name}`);\n  }\n  static check(name) {\n    if (!name.match(/^[a-z0-9_\\.-]*$/))\n      throw new DefinitionNameError(name);\n  }\n}\n\nclass AsyncDefinitionError extends DefinitionError {\n  constructor(msg, fullname, rule, RuleFun) {\n    super(msg, fullname, rule, RuleFun);\n    //side-effect in constructor!!\n    document.documentElement.dispatchEvent(new ErrorEvent(this));\n  }\n}\n\nObject.assign(DoubleDots, {\n  DefinitionError,\n  TriggerNameError,\n  DefinitionNameError,\n  AsyncDefinitionError\n});\n\nclass DefinitionsMap {\n\n  #definitions = {};\n  #rules = {};\n  // #ruleRE = new RegExp(\" \", \"g\");\n\n  defineRule(prefix, FunFun) {\n    //FunFun can be either a Function that given the prefix will produce either a class or a Function.\n    //FunFun can also be a Promise.\n    DefinitionNameError.check(prefix);\n    for (let r of Object.keys(this.#rules))\n      if (r.startsWith(prefix) || prefix.startsWith(r))\n        throw new DefinitionError(`rule/rule conflict: trying to add '${prefix}' when '${r}' exists.`);\n    for (let fullname of Object.keys(this.#definitions))\n      if (fullname.startsWith(prefix))\n        throw new DefinitionError(`rule/name conflict: trying to add '${prefix}' when '${fullname}' exists.`);\n    // this.#ruleRE = new RegExp(`^(${Object.keys(this.#rules).join(\"|\")}).*`, \"g\");\n    this.#rules[prefix] = FunFun;\n    FunFun instanceof Promise && FunFun\n      .then(newFunFun => this.#rules[prefix] = newFunFun)\n      .catch(err => this.#rules[prefix] = new AsyncDefinitionError(err, null, prefix));\n  }\n\n  define(fullname, Def) {\n    //Def can be either a class or a Function.\n    //Def can also be a Promise.\n    DefinitionNameError.check(fullname);\n    if (fullname in this.#definitions)\n      throw new DefinitionError(`name/name conflict: '${fullname}' already exists.`);\n    for (let r of Object.keys(this.#rules))\n      if (fullname.startsWith(r))\n        throw new DefinitionError(`name/rule conflict: trying to add '${fullname}' when rule '${r}' exists.`);\n    this.#definitions[fullname] = Def;\n    Def instanceof Promise && Def\n      .then(newDef => this.#definitions[fullname] = newDef)\n      .catch(err => this.#definitions[fullname] = new AsyncDefinitionError(err, fullname));\n  }\n\n  #processRule(fullname, rule, FunFun) {\n    if (FunFun instanceof Promise)\n      return this.#definitions[fullname] = FunFun\n        .then(newFunFun => (FunFun = newFunFun)(fullname))\n        .catch(err => new AsyncDefinitionError(err, null, rule, null))\n        .then(newDef => this.#definitions[fullname] = newDef)\n        .catch(err => this.#definitions[fullname] = new AsyncDefinitionError(err, fullname, rule, FunFun));\n\n    try {\n      if (FunFun instanceof Error)\n        throw FunFun;\n      const Def = this.#definitions[fullname] = FunFun(fullname);\n      Def instanceof Promise && Def\n        .then(newDef => this.#definitions[fullname] = newDef)\n        .catch(err => this.#definitions[fullname] = new AsyncDefinitionError(err, fullname, rule, FunFun));\n      return Def;\n    } catch (err) {\n      return this.#definitions[fullname] = new DefinitionError(err, fullname, rule, FunFun);\n    }\n  }\n\n  #checkViaRule(fullname) {\n    // alternative logic using a regex to match the name. Not sure this is better\n    // for (let [_, prefix] of fullname.matchAll(this.#ruleRE))\n    //   return this.#definitions[fullname] = this.#rules[prefix](fullname);\n    for (let [rule, FunFun] of Object.entries(this.#rules))\n      if (fullname.startsWith(rule))\n        return this.#processRule(fullname, rule, FunFun);\n  }\n\n  get(fullname) {\n    return this.#definitions[fullname] || this.#checkViaRule(fullname);\n  }\n}\n\n/**\n * Whenever you request an unknown definition, \n * you get an UnknownDefinition Promise.\n * When later a matching definition is added,\n * this promise will resolve with the new definition.\n * If this promise is rejected from the outside,\n * The UnknownDefinitionsMap will automatically clean\n * itself up.\n * \n * To avoid memory leaks with !isConnected attributes,\n * a 10sec loop checks the UnknownDefinitions and removes \n * any disconnected Promises.\n */\nclass UnknownDefinition extends Promise {\n  static make(attr) {\n    let resolve, reject;\n    const promise = new UnknownDefinition((a, b) => {\n      resolve = a;\n      reject = b;\n    });\n    return Object.assign(promise, { resolve, reject, attr });\n  }\n}\n\nclass PromiseMap {\n  unknowns = {};\n  #interval;\n\n  make(fullname, attr) {\n    const p = UnknownDefinition.make(attr);\n    (this.unknowns[fullname] ??= []).push(p);\n    p.catch(_ => this.remove(fullname, p));\n    this.#interval || this.#cleanLoop();\n    return p;\n  }\n\n  async #cleanLoop() {\n    this.#interval = true;\n    while (true) {\n      await new Promise(r => setTimeout(r, 10000));\n      const all = Object.entries(this.unknowns);\n      if (!all.length)\n        return this.#interval = false;\n      for (let [fullname, promises] of all)\n        for (let p of promises.filter(p => !p.attr.isConnected))\n          this.remove(fullname, p);\n    }\n  }\n\n  remove(fullname, p) {\n    const promises = this.unknowns[fullname];\n    if (!promises)\n      return;\n    const i = promises.indexOf(p);\n    if (i < 0)\n      return;\n    promises.splice(i, 1);\n    !promises.length && delete this.unknowns[fullname];\n  }\n\n  complete(fullname) {\n    const promises = this.unknowns[fullname];\n    delete this.unknowns[fullname];\n    for (let p of promises || [])\n      try { p.resolve(); } catch (_) { } //Att!! handle errors outside\n  }\n  completeRule(rule) {\n    for (let fullname in this.unknowns)\n      if (fullname.startsWith(rule))\n        this.complete(fullname);\n  }\n}\n\nclass UnknownDefinitionsMap extends DefinitionsMap {\n  #unknowns = new PromiseMap();\n  define(fullname, Def) {\n    super.define(fullname, Def);\n    this.#unknowns.complete(fullname);\n  }\n\n  defineRule(rule, FunClass) {\n    super.defineRule(rule, FunClass);\n    this.#unknowns.completeRule(rule);\n  }\n\n  //todo add attr\n  get(fullname, attr) {\n    return super.get(fullname) ?? this.#unknowns.make(fullname, attr);\n  }\n}\n\nclass DefinitionsMapLock extends UnknownDefinitionsMap {\n  #lock;\n  defineRule(rule, FunFun) {\n    if (this.#lock)\n      throw new DefinitionError(\"ShadowRoot too-late definition error for rule: \" + rule);\n    return super.defineRule(rule, FunFun);\n  }\n\n  define(name, Def) {\n    if (this.#lock)\n      throw new DefinitionError(\"ShadowRoot too-late definition error for definition: \" + name);\n    return super.define(name, Def);\n  }\n\n  get(name) {\n    this.#lock = true;\n    return super.get(name);\n  }\n}\n\n//this map inherits\nclass DefinitionsMapDOM extends DefinitionsMapLock {\n  #root;\n  #type;\n  constructor(root, type) {\n    super();\n    this.#root = root;\n    this.#type = type;\n  }\n\n  get root() {\n    return this.#root;\n  }\n\n  get type() {\n    return this.#type;\n  }\n\n  get parentMap() {\n    return this.root.host?.getRootNode()?.[this.type];\n  }\n\n  get(name) {\n    return super.get(name) || this.parentMap.get(name);\n  }\n}\n\nclass DefinitionsMapDOMOverride extends DefinitionsMapDOM {\n\n  #cache = {};\n  #rule;\n\n  /**\n   * \"name|prefix.*|another-name|prefix2_.*\"\n   * and is simply wrapped in ^(...) to complete the regex query.\n   */\n  get rule() {\n    return this.#rule ??= `^(${this.root.host.getAttribute(\"override-\" + this.type.toLowercase())})`;\n  }\n\n  /**\n   * @param {string} name \n   * @returns {DefinitionsMap|false} if the name has been overridden above.\n   */\n  overrides(name) {\n    return this.#cache[name] ??= this.parentMap?.overrides?.(name) || this.rule.matches(name) && this.parentMap;\n  }\n\n  /**\n   * First, we check if there is an override root. If there is, we redirect the query directly to that root instead.\n   * Second, we try to use our own definitions, and then inherited definitions.\n   * @param {string} name \n   * @returns DefinitionsMap from the document that overrides the definition name \n   */\n  get(name) {\n    const overrider = this.overrides(name);\n    return overrider ? overrider.get(name) : super.get(name);\n  }\n}\n\nfunction TriggerSyntaxCheck(DefMap) {\n  return class TriggerMap extends DefMap {\n    defineRule(prefix, FunFun) {\n      TriggerNameError.check(prefix);\n      super.defineRule(prefix, FunFun);\n    }\n\n    define(fullname, Def) {\n      TriggerNameError.check(fullname);\n      super.define(fullname, Def);\n    }\n  };\n}\n\nfunction ReactionThisInArrowCheck(DefMap) { //todo add this to Reaction maps?\n  return class ReactionMapNoThisInArrow extends DefMap {\n    define(fullname, Def) {\n      DoubleDots.ThisArrowFunctionError.check(Def);\n      super.define(fullname, Def);\n    }\n  };\n}\n\n\nObject.defineProperties(Document.prototype, {\n  Reactions: {\n    get: function () {\n      const map = new UnknownDefinitionsMap();\n      Object.defineProperty(this, \"Reactions\", { value: map, enumerable: true });\n      return map;\n    }\n  },\n  Triggers: {\n    configurable: true,\n    get: function () {\n      const TriggerMap = TriggerSyntaxCheck(UnknownDefinitionsMap);\n      const map = new TriggerMap();\n      Object.defineProperty(this, \"Triggers\", { value: map, enumerable: true });\n      return map;\n    }\n  }\n});\nObject.defineProperties(ShadowRoot.prototype, {\n  Reactions: {\n    configurable: true,\n    get: function () {\n      const map = new DefinitionsMapDOMOverride(this, \"Reactions\");\n      Object.defineProperty(this, \"Reactions\", { value: map, enumerable: true });\n      return map;\n    }\n  },\n  Triggers: {\n    configurable: true,\n    get: function () {\n      const TriggerMap = TriggerSyntaxCheck(DefinitionsMapDOMOverride);\n      const map = new TriggerMap(this, \"Triggers\");\n      Object.defineProperty(this, \"Triggers\", { value: map, enumerable: true });\n      return map;\n    }\n  }\n});\n\n/**\n * ## `DoubleDots.Reference` rules.\n * \n * 1. the resource inside the module file is identified by the value||name.\n * 2. Names starting with upCase imply Triggers `/[^a-zA-Z]*[A-Z]/`\n *    Names starting with lowCase imply Reactions `/[^a-zA-Z]*[A-Z]/`\n * 3. Names ending with `/[a-zA-Z]/` are regular definitions.\n *    Names ending with non-letters such as `/_-\\./` are rules.\n * 4. The refName is a snake-case of the CamelCaseName.\n *    The first letter (in trigger references) are not `-`prefixed.\n */\nclass Reference {\n  constructor(url, name, value) {\n    this.url = url;\n    this.name = name;\n    this.fullname = DoubleDots.pascalToKebab(DoubleDots.pascalToCamel(name));\n    this.value = value || \"\";\n    this.type = /^_*[A-Z]/.test(name) ? \"Triggers\" : \"Reactions\";\n    this.rule = /[\\._-]$/.test(name) ? \"defineRule\" : \"define\";\n  }\n\n  async getDefinition() {\n    const module = await import(this.url);\n    if (!module || typeof module !== \"object\" && !(module instanceof Object))\n      throw new TypeError(`URL is not an es6 module: ${this.url}`);\n    const lookup = this.value || this.name;\n    const def = module[lookup];\n    if (def) return def;\n    for (let [k, v] of Object.entries(module))\n      if (k.startsWith(\"dynamic\"))\n        if (v[lookup])\n          return v[lookup];\n    throw new TypeError(`ES6 module doesn't contain resource: ${lookup}`);\n  }\n\n  static *parse(url) {\n    const hashSearch = (url.hash || url.search).slice(1);\n    if (!hashSearch)\n      throw DoubleDots.SyntaxError(\"DoubleDots.Reference not in url: \" + url);\n    const refs = hashSearch.entries?.() ?? hashSearch.split(\"&\").map(s => s.split(\"=\"));\n    for (let [name, value] of refs)\n      yield new Reference(url, name, value);\n  }\n}\n\nasync function define(url, root) {\n  for (let ref of Reference.parse(url))\n    root[ref.type][ref.rule](ref.fullname, ref.getDefinition());\n};\n\nObject.assign(DoubleDots, {\n  DefinitionsMap,\n  DefinitionsMapLock,\n  DefinitionsMapDOM,\n  DefinitionsMapDOMOverride,\n  UnknownDefinitionsMap,\n  UnknownDefinition,\n  Reference,\n  define,\n});\n", "//.attachShadow(/*always open*/); is necessary to capture the full composedPath of customEvents.\nconst attachShadowOG = HTMLElement.prototype.attachShadow;\nHTMLElement.prototype.attachShadow = function attachShadowforceModeOpen(...args) {\n  (args[0] ??= {}).mode = \"open\";\n  return attachShadowOG.apply(this, args);\n};\n\nEvent.data = Symbol(\"Event data\");\nclass EventLoopError extends DoubleDots.DoubleDotsError { }\nDoubleDots.EventLoopError = EventLoopError;\n\nclass MicroFrame {\n  #i = 0;\n  #names;\n  #inputs;\n  #outputs;\n\n  constructor(event, at) {\n    this.at = at;\n    this.event = event;\n    this.#names = this.at.reactions;\n    this.#inputs = [event[Event.data] ?? event];\n    this.#outputs = [];\n  }\n\n  isConnected() {\n    return this.at.isConnected();\n  }\n\n  getReaction() {\n    return this.#i < this.#names.length ? this.#names[this.#i] : undefined;\n  }\n\n  getReactionIndex() {\n    return this.#i < this.#names.length ? this.#i : -1;\n  }\n\n  nextReaction() {\n    // this.#i++;\n    return this.getReaction();\n  }\n\n  /**\n   * @returns <undefined> when the task is emptied, or is awaiting in async mode, \n   * which both means that the event loop can continue.\n   * @returns <this> current task when the task is not emptied \n   * and we must wait for it in sync mode.\n   */\n  run(threadMode = false) {\n    for (let re = this.getReaction(); re !== undefined; re = this.nextReaction()) {\n      //1. process native reactions\n      if (re === \"\") {\n        threadMode = true;\n        this.#runSuccess(this.#inputs[this.#i]);\n        continue;\n      }\n      //todo this one\n      if (re.startsWith(\"catch\"))\n        continue;\n\n      //2. check isConnected\n      try {\n        if (!this.at.isConnected)\n          throw new EventLoopError(\"Disconnected: \" + this.at);\n        //todo should this be an error??\n\n        const func = this.at.getRootNode().Reactions.get(re, this.at);\n        if (func instanceof Error)\n          throw func;\n        if (func instanceof Promise) {\n          if (threadMode) {\n            func.then(_ => __eventLoop.asyncContinue(this));\n            return; //continue outside loop\n          } else if (func instanceof DoubleDots.UnknownDefinition) {\n            return this.#runError(new EventLoopError(\"Reaction not found: \" + re));\n            //RulePromise, DefinitionPromise\n          } else {\n            func.then(_ => __eventLoop.syncContinue());\n            //todo these sync delays needs to have a max timeout.\n            //todo thus, we need to have some max timers\n            return this; //halt outside loop\n          }\n        }\n        // const self = this.#selves[this.#i];\n        //todo this.#inputs.slice().reverse() is inefficient.\n        const res = this.#outputs[this.#i] = func.apply(this.at, this.#inputs.slice().reverse());\n        if (res instanceof Promise) {\n          if (threadMode) {\n            res.then(oi => this.#runSuccess(oi))\n              .catch(error => this.#runError(error))\n              .finally(_ => __eventLoop.asyncContinue(this));\n            return; //continue outside loop\n          } else {\n            res.then(oi => this.#runSuccess(oi))\n              .catch(error => this.#runError(error))\n              .finally(_ => __eventLoop.syncContinue());\n            //todo these sync delays needs to have a max timeout.\n            //todo thus, we need to have some max timers\n            return this; //halt outside loop\n          }\n        }\n        this.#runSuccess(res);\n      } catch (error) {\n        this.#runError(error);\n      }\n    }\n  }\n\n  #runError(error) {\n    console.error(error);\n    this.#outputs[this.#i] = error;\n    const catchKebab = \"catch_\" + error.constructor.name.replace(/[A-Z]/g, '-$&').toLowerCase();\n    for (this.#i++; this.#i < this.#names.length; this.#i++)\n      if (this.#names[this.#i] === \"catch\" || this.#names[this.#i] === catchKebab)\n        return;\n\n    // this.#i = this.#names.length;\n    const target = this.at.isConnected ? this.at.ownerElement : document.documentElement;\n    //todo add the at + reactionIndex + self + input to the ErrorEvent, so that we know which attribute caused the error\n    //todo or just the at, and then just read the data from the _eventLoop?\n    target.dispatchEvent(new ErrorEvent(\"error\", { error }));\n  }\n\n  #runSuccess(res) {\n    this.#outputs[this.#i] = res;\n    if (res === EventLoop.Break) {\n      this.#i = this.#names.length;\n    } else if (res instanceof EventLoop.ReactionJump) { //this also looks frail\n      const next = this.#i + res.value;\n      // this.#selves[next] = this.#selves[this.#i];\n      this.#inputs[next] = this.#inputs[this.#i];\n      this.#i = next;\n      // } else if (res instanceof EventLoop.ReactionOrigin) {\n      //   const next = this.#i + 1;\n      //   // this.#selves[next] = res.value;\n      //   this.#inputs[next] = this.#inputs[this.#i];\n      //   this.#i = next;\n    } else {\n      const next = this.#i + 1;\n      // this.#selves[next] = this.#selves[this.#i];\n      this.#inputs[next] = res;\n      this.#i = next;\n    }\n  }\n}\n\nclass __EventLoop {\n  #stack = [];\n  #started = [];\n  task;\n\n  syncContinue() {\n    if (!(this.task = this.task.run()))\n      this.loop();\n  }\n\n  asyncContinue(task) {\n    (this.task = task).run(true);\n  }\n\n  loop() {\n    while (this.#stack[0]) {\n      const { event, iterator } = this.#stack[0];\n      for (let attr of iterator) {\n        this.task = new MicroFrame(event, attr);\n        this.#started.push(this.task);\n        //if task.run() not emptied, abort to halt eventloop\n        if (this.task = this.task.run())\n          return;\n      }\n      this.#stack.shift();\n    }\n  }\n\n  batch(event, iterable) {\n    const iterator = iterable[Symbol.iterator]();\n    if (this.#stack.push({ event, iterator }) === 1)\n      this.loop();\n  }\n}\n\n__eventLoop = new __EventLoop();\n\n//external interface\nwindow.EventLoop = class EventLoop {\n  static ReactionJump = class ReactionJump {\n    constructor(n) {\n      n = parseInt(n);\n      if (!n || isNaN(n))\n        throw new DoubleDotsErrorEvent(\"ReactionJump must be done using a positive or negative integer.\");\n      this.value = n;\n    }\n  };\n\n  static Break = {};\n\n  static ReactionOrigin = class ReactionOrigin {\n    constructor(obj) {\n      if (!obj || !(obj instanceof Object))\n        throw new DoubleDotsErrorEvent(\"ReactionOrigin must be an object not null.\");\n      this.value = obj;\n    }\n  };\n\n  static SpreadReaction = function (fun) {\n    return function SpreadReaction(oi) {\n      return oi instanceof Iterable ?\n        fun.call(this, ...oi) :\n        fun.call(this, oi);\n      // if (oi instanceof Iterable)\n      //   return fun.call(this, ...oi);\n      // throw new DoubleDotsSpreadReactionError(\"SpreadReactions must be passed a spreadable oi argument\");\n    };\n  };\n\n  //todo freeze the ReactionOrigin, SpreadReaction, ReactionJump, Break.\n\n  get event() {\n    return __eventLoop.task?.event;\n  }\n\n  get attribute() {\n    return __eventLoop.task?.at;\n  }\n\n  get reaction() {\n    return __eventLoop.task?.getReaction();\n  }\n\n  get reactionIndex() {\n    return __eventLoop.task?.getReactionIndex();\n  }\n\n  dispatch(event, attr) {\n    __eventLoop.batch(event, [attr]);\n  }\n\n  //todo rename to propagate\n  dispatchBatch(event, iterable) {\n    __eventLoop.batch(event, iterable);\n  }\n};\nObject.defineProperty(window, \"eventLoop\", { value: new EventLoop() });", "const Specializers = {\n  cloneNode: [Node.prototype, DocumentFragment.prototype],\n  innerHTML: [Element.prototype, HTMLTemplateElement.prototype],\n  insertAdjacentHTML: [Element.prototype, HTMLTemplateElement.prototype],\n};\nfor (let [m, [TOP, DOWN]] of Object.entries(Specializers))\n  Object.defineProperty(DOWN, m, Object.getOwnPropertyDescriptor(TOP, m));\n\n// const state = [...document.querySelectorAll(\"*\")];\n//1. Since the DoubleDots is the only script.\n//   The DoubleDots then runs so, we can just iterate on the main document.\n//   Listen for the native DCL, and then upgrade the branch of the document.\n//2. the adding HTML template methods. innerHTML + insertAdjacentHTML.\n//3. setAttribute.\n//   remember to disallow override-x attribute names immutable. Anything that starts with `override-` is illegal from setAttribute? yes.\n//4. AttrUnknown upgradeUpgrade\n//   1. It can only happen when new Trigger Defs are added to the main document.Triggers. \n//      This is because the shadowRoot.Triggers are locked post register time.\n//5. WaitForItAttr. Promise Definitions.\n\nfunction monkeyPatchSetter(proto, prop, fun) {\n  const desc = Object.getOwnPropertyDescriptor(proto, prop);\n  desc.set = fun;\n  Object.defineProperty(proto, prop, desc);\n}\n\nfunction monkeyPatch(proto, prop, fun) {\n  const desc = Object.getOwnPropertyDescriptor(proto, prop);\n  desc.value = fun;\n  Object.defineProperty(proto, prop, desc);\n}\n\n(function (Element_p, ShadowRoot_p) {\n  const Element_innerHTML_OG = Object.getOwnPropertyDescriptor(Element_p, \"innerHTML\").set;\n  const innerHTML_DD_el = function innerHTML_DD(val) {\n    Element_innerHTML_OG.call(this, val);\n    AttrCustom.upgradeBranch(...this.children); //todo untested fix from project\n  };\n\n  const ShadowRoot_innerHTML_OG = Object.getOwnPropertyDescriptor(ShadowRoot_p, \"innerHTML\").set;\n  const innerHTML_DD_sr = function innerHTML_DD(val) {\n    ShadowRoot_innerHTML_OG.call(this, val);\n    AttrCustom.upgradeBranch(...this.children); //todo untested fix from project\n  };\n\n  const insertAdjacentHTMLOG = Element_p.insertAdjacentHTML;\n  function insertAdjacentHTML_DD(position, ...args) {\n    //todo test the different versions here\n    let root, index;\n    if (position === \"afterbegin\")\n      root = this, index = 0;\n    else if (position === \"beforeend\")\n      root = this, index = this.children.length;\n    else if (position === \"beforebegin\")\n      root = this.parentNode, index = Array.prototype.indexOf.call(root.children, this);\n    else if (position === \"afterend\")\n      root = this.parentNode, index = Array.prototype.indexOf.call(root.children, this) + 1;\n    const childCount = root.children.length;\n    insertAdjacentHTMLOG.call(this, position, ...args);\n    const addCount = root.children.length - childCount;\n    const newRoots = Array.from(root.children).slice(index, index + addCount);\n    AttrCustom.upgradeBranch(...newRoots);\n  }\n\n  const setAttributeOG = Element_p.setAttribute;\n  const getAttributeNodeOG = Element_p.getAttributeNode;\n  function setAttribute_DD(name, value) {\n    //0. syntax error for \"override-\"\n    if (name.startsWith(\"override-\"))\n      throw new SyntaxError(\"You can only set [override-xyz] attributes on elements in HTML template: \" + name);\n    //1. treat the normal normal\n    if (!name.includes(\":\"))\n      return setAttributeOG.call(this, name, value);\n    //2. if the name is DoubleDots\n    let at = getAttributeNodeOG.call(this, name);\n    if (at) {\n      at.value !== value && (at.value = value);\n      return;\n    }\n    setAttributeOG.call(this, name, value);\n    at = getAttributeNodeOG.call(this, name);\n    AttrCustom.upgrade(at);\n  }\n\n  monkeyPatchSetter(Element_p, \"innerHTML\", innerHTML_DD_el);\n  monkeyPatchSetter(ShadowRoot_p, \"innerHTML\", innerHTML_DD_sr);\n  monkeyPatch(Element_p, \"insertAdjacentHTML\", insertAdjacentHTML_DD);\n  monkeyPatch(Element_p, \"setAttribute\", setAttribute_DD);\n})(Element.prototype, ShadowRoot.prototype);\n\n(function () {\n  //todo we need the innerHTML and insertAdjacentHTML and setAttribute to be added to the nativeMethods.\n\n  //JS injections is allowed when we\n  //1) move elements within the same rootNode (no upgrade of AttrCustom)\n  //2) move elements from one DocumentFragment to another (no upgrade of AttrCustom)\n  //3) inject elements *from* DocumentFragments to an .isConnected element (DO upgrade of AttrCustom)\n  //* otherwise just fail.\n  function checkRoot(root, child, r = root.getRootNode(), cr = child?.getRootNode()) {\n    if (!(child instanceof Element) || cr === r || (cr instanceof DocumentFragment && r instanceof DocumentFragment))\n      return false;\n    if (root.isConnected && cr instanceof DocumentFragment)\n      return true;\n    throw new DoubleDots.InsertElementFromJSError(root, child);\n\n  }\n  const EMPTY = [];\n  function sameRootFirstArg(child) {\n    return checkRoot(this, child) ? [child] : EMPTY;\n  }\n  function sameRootSecond(_, child) {\n    return checkRoot(this, child) ? [child] : EMPTY;\n  }\n  function sameRootSpreadArg(...args) {\n    const r = this.getRootNode();\n    return args.filter(child => checkRoot(this, child, r));\n  }\n\n  const Mask = {\n    \"Comment.prototype\": {\n      after: sameRootSpreadArg,\n      before: sameRootSpreadArg,\n      insertBefore: sameRootFirstArg,\n    },\n    \"Text.prototype\": {\n      after: sameRootSpreadArg,\n      before: sameRootSpreadArg,\n      insertBefore: sameRootFirstArg,\n    },\n    \"Element.prototype\": {\n      //replaceChild\n      after: sameRootSpreadArg,\n      before: sameRootSpreadArg,\n      appendChild: sameRootFirstArg,\n      insertBefore: sameRootFirstArg,\n      append: sameRootSpreadArg,\n      prepend: sameRootSpreadArg,\n      insertAdjacentElement: sameRootSecond,\n    },\n    \"Document.prototype\": {\n      //replaceChild\n      appendChild: sameRootFirstArg,\n      insertBefore: sameRootFirstArg,\n      append: sameRootSpreadArg,\n      prepend: sameRootSpreadArg,\n    },\n    \"DocumentFragment.prototype\": {\n      //replaceChild\n      appendChild: sameRootFirstArg,\n      insertBefore: sameRootFirstArg,\n      append: sameRootSpreadArg,\n      prepend: sameRootSpreadArg,\n    }\n  };\n\n  function monkeyPatch(proto, prop, value) {\n    Object.defineProperty(proto, prop, {\n      ...Object.getOwnPropertyDescriptor(proto, prop), value\n    });\n  }\n\n  function verifyAndUpgrade(OG, verify) {\n    return function (...args) {\n      const upgrades = verify.call(this, ...args);\n      const res = OG.apply(this, args);\n      upgrades.length && AttrCustom.upgradeBranch(...upgrades);\n      return res;\n    };\n  }\n\n  for (let [path, objMask] of Object.entries(Mask)) {\n    path = path.split(\".\");\n    const obj = path.reduce((o, p) => o[p], window);\n    const nativeObj = path.reduce((o, p) => o[p] ??= {}, DoubleDots.nativeMethods);\n    for (let [prop, verifyMethod] of Object.entries(objMask)) {\n      const OG = nativeObj[prop] = obj[prop];\n      const newFunc = verifyAndUpgrade(OG, verifyMethod);\n      monkeyPatch(obj, prop, newFunc);\n    }\n  }\n})();\n\n//_:define  => must be installed to enable the loading of doubledots triggers and reactions.\n(function () {\n\n  //Att!! Only call the :define reaction once, either using _: or :once\n  //_:define=\"url?name=value\" \n  function define() {\n    const src = this.ownerElement.getAttribute(\"src\");\n    const base = src ? new URL(src, location) : location;\n    DoubleDots.define(new URL(this.value, base), this.ownerDocument);\n  }\n\n  class AttrEmpty extends AttrCustom {\n    upgrade() { eventLoop.dispatch(new Event(this.trigger), this); }\n  };\n\n  document.Reactions.define(\"define\", define);\n  document.Triggers.define(\"_\", AttrEmpty);\n})();\n\n//_t: and :_t => trigger-reaction pair for extracting and retrieving the childNodes as a template. _tt: is an alternative to _t: that will not re-interpret the html-nodes, but it *can only be added in html template text, not via setAttribute() from js*. To implement this, we could add a parameter to upgrade that says what context the current upgrade is called from. It is easy to add such an argument for the simple case when .setAttribute() is done via js.\n// const map = new WeakMap();\n// class _T extends AttrCustom {\n//   upgrade() {\n//     const t = document.createElement(\"template\");\n//     t.innerHTML = this.ownerElement.innerHTML;\n//     map.set(this.ownerElement, t.content);\n//     this.ownerElement.textContent = \"\";\n//   }\n// }\n// class _Tt extends AttrCustom {\n//   upgrade() {\n//     const df = document.createDocumentFragment();\n//     df.append(...this.ownerElement.childNodes);\n//     map.set(this.ownerElement, df);\n//     this.ownerElement.textContent = \"\";\n//   } \n// }\n// function _t() {\n//   return map.get(this.ownerElement);\n// }\n// document.Triggers.define(\"_t\", _T);\n// document.Triggers.define(\"_tt\", _Tt);\n// document.Reactions.define(\"_t\", _t);\n", "(function () {\n  const ElAppendOG = DoubleDots.nativeMethods.Element.prototype.append;\n  const DocfragAppendOG = DoubleDots.nativeMethods.DocumentFragment.prototype.append;\n  const CommentAfterOG = DoubleDots.nativeMethods.Comment.prototype.after;\n\n  function subsumeNodes(el) {\n    const t = document.createElement(\"template\");\n    DocfragAppendOG.call(t.content, ...el.childNodes);\n    ElAppendOG.call(el, t);\n    return t;\n  }\n\n  function subsumeHtml(el) {\n    el.innerHTML = `<template>${el.innerHTML}</template>`;\n    return el.children[0];\n  }\n\n  function absorbNodes(before, nodes) {\n    const t = document.createElement(\"template\");\n    DocfragAppendOG.call(t.content, ...nodes);\n    CommentAfterOG.call(before, t);\n  }\n\n  function absorbHtml(before, nodes) {\n    const txt = nodes.map(n =>\n      n.outerHTML ?? n instanceof Comment ? `<!--${n.textContent}-->` : n.textContent);\n    nodes.forEach(n => n.remove());\n    before.insertAdjacentHTML(\"afterend\", `<template>${txt.join(\"\")}</template>`);\n  }\n\n  const usedEnds = new WeakSet();\n\n  function gobble(n) {\n    let txt = n.textContent.trim();\n    if (!txt.match(/^template(\\s|)/))\n      return;\n    const res = [];\n    while (n = n.nextSibling) {\n      if (n instanceof Comment && !usedEnds.has(n)) {\n        if ((txt = n.textContent.trim()).match(/^\\/template(\\s|)/)) {\n          usedEnds.add(n);\n          break;\n        }\n      }\n      res.push(n);\n    }\n    return res;\n  }\n\n  function descendantsReverse(root, trigger) {\n    const it = document.createNodeIterator(root, NodeFilter.SHOW_ELEMENT);\n    const elements = [], attributes = [];\n    for (let n; n = it.nextNode();) {\n      for (let a of n.attributes)\n        if (a.name.startsWith(trigger)) {\n          attributes.push(a);\n          elements.unshift(n);\n          break;\n        }\n    }\n    return { elements, attributes };\n    // return [...root.querySelectorAll(`[${trigger}\\\\:]`)].reverse();\n  }\n\n  function commentsRightToLeft(docFrag) {\n    const it = document.createNodeIterator(docFrag, NodeFilter.SHOW_COMMENT);\n    let res = [];\n    for (let n; n = it.nextNode();)\n      res.unshift(n);\n    return res;\n  }\n\n  class Template extends AttrCustom {\n    upgrade(dynamic) {\n      const el = this.ownerElement;\n      if (el.childNodes.length === 0 || el.children.length === 1 && el.children[0] instanceof HTMLTemplateElement)\n        return;\n      if (el instanceof HTMLTemplateElement)\n        throw new Error(\"template trigger cannot be applied to template elements.\");\n      const subsume = dynamic ? subsumeHtml : subsumeNodes;\n      const absorb = dynamic ? absorbHtml : absorbNodes;\n\n      const { elements, attributes } = descendantsReverse(el, this.trigger + \":\");\n      const templates = elements.map(subsume);\n      let gobbledNodes;\n      for (let t of templates)\n        for (let comment of commentsRightToLeft(t.content))\n          if (gobbledNodes = gobble(comment))\n            absorb(comment, gobbledNodes);\n      //todo now we don't have any events coming from the template: trigger.\n      //todo below is what it looks like if we upgrade and dispatch an event using downward propagation.\n      // for (let a of attributes)\n      //   AttrCustom.upgrade(a);\n      // eventLoop.dispatchBatch(new Event(\"template\"), [attributes]);\n    }\n  }\n\n  document.Triggers.define(\"template\", Template);\n\n  // todo this is no longer needed. We can now just use el.children.0\n  function template() {\n    return this.ownerElement.children[0];\n  }\n  document.Reactions.define(\"template\", template);\n})();", "(function (aelOG) {\n  if (document.readyState !== \"loading\")\n    return AttrCustom.upgradeBranch(document.htmlElement);\n  aelOG.call(document, \"DOMContentLoaded\", _ => AttrCustom.upgradeBranch(document.documentElement));\n})(EventTarget.prototype.addEventListener);"],
  "mappings": "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",
  "names": ["_a", "Def", "AttrCustom", "p", "monkeyPatch", "define"]
}
